{
  "version": 3,
  "sources": ["../node_modules/@remix-run/dev/dist/config/defaults/entry.server.node.tsx", "../app/root.tsx", "../app/routes/webhooks.app_uninstalled.tsx", "../app/lib/webhooks.server.ts", "../app/lib/prisma.server.ts", "../app/routes/webhooks.products_update.tsx", "../app/routes/admin.branding.tsx", "../app/lib/session.server.ts", "../app/routes/auth.callback.tsx", "../app/lib/shopify-auth.server.ts", "../app/lib/crypto.server.ts", "../app/lib/shop.server.ts", "../app/routes/api.settings.tsx", "../app/lib/validation.server.ts", "../app/routes/auth.install.tsx", "../app/routes/api.config.tsx", "../app/routes/test.oauth.tsx", "../app/routes/healthz.tsx", "../app/routes/_index.tsx", "../app/routes/admin.tsx", "server-assets-manifest:@remix-run/dev/assets-manifest", "server-entry-module:@remix-run/dev/server-build"],
  "sourcesContent": ["import { PassThrough } from \"node:stream\";\n\nimport type { AppLoadContext, EntryContext } from \"@remix-run/node\";\nimport { createReadableStreamFromReadable } from \"@remix-run/node\";\nimport { RemixServer } from \"@remix-run/react\";\nimport * as isbotModule from \"isbot\";\nimport { renderToPipeableStream } from \"react-dom/server\";\n\nconst ABORT_DELAY = 5_000;\n\nexport default function handleRequest(\n  request: Request,\n  responseStatusCode: number,\n  responseHeaders: Headers,\n  remixContext: EntryContext,\n  loadContext: AppLoadContext\n) {\n  let prohibitOutOfOrderStreaming =\n    isBotRequest(request.headers.get(\"user-agent\")) || remixContext.isSpaMode;\n\n  return prohibitOutOfOrderStreaming\n    ? handleBotRequest(\n        request,\n        responseStatusCode,\n        responseHeaders,\n        remixContext\n      )\n    : handleBrowserRequest(\n        request,\n        responseStatusCode,\n        responseHeaders,\n        remixContext\n      );\n}\n\n// We have some Remix apps in the wild already running with isbot@3 so we need\n// to maintain backwards compatibility even though we want new apps to use\n// isbot@4.  That way, we can ship this as a minor Semver update to @remix-run/dev.\nfunction isBotRequest(userAgent: string | null) {\n  if (!userAgent) {\n    return false;\n  }\n\n  // isbot >= 3.8.0, >4\n  if (\"isbot\" in isbotModule && typeof isbotModule.isbot === \"function\") {\n    return isbotModule.isbot(userAgent);\n  }\n\n  // isbot < 3.8.0\n  if (\"default\" in isbotModule && typeof isbotModule.default === \"function\") {\n    return isbotModule.default(userAgent);\n  }\n\n  return false;\n}\n\nfunction handleBotRequest(\n  request: Request,\n  responseStatusCode: number,\n  responseHeaders: Headers,\n  remixContext: EntryContext\n) {\n  return new Promise((resolve, reject) => {\n    let shellRendered = false;\n    const { pipe, abort } = renderToPipeableStream(\n      <RemixServer\n        context={remixContext}\n        url={request.url}\n        abortDelay={ABORT_DELAY}\n      />,\n      {\n        onAllReady() {\n          shellRendered = true;\n          const body = new PassThrough();\n          const stream = createReadableStreamFromReadable(body);\n\n          responseHeaders.set(\"Content-Type\", \"text/html\");\n\n          resolve(\n            new Response(stream, {\n              headers: responseHeaders,\n              status: responseStatusCode,\n            })\n          );\n\n          pipe(body);\n        },\n        onShellError(error: unknown) {\n          reject(error);\n        },\n        onError(error: unknown) {\n          responseStatusCode = 500;\n          // Log streaming rendering errors from inside the shell.  Don't log\n          // errors encountered during initial shell rendering since they'll\n          // reject and get logged in handleDocumentRequest.\n          if (shellRendered) {\n            console.error(error);\n          }\n        },\n      }\n    );\n\n    setTimeout(abort, ABORT_DELAY);\n  });\n}\n\nfunction handleBrowserRequest(\n  request: Request,\n  responseStatusCode: number,\n  responseHeaders: Headers,\n  remixContext: EntryContext\n) {\n  return new Promise((resolve, reject) => {\n    let shellRendered = false;\n    const { pipe, abort } = renderToPipeableStream(\n      <RemixServer\n        context={remixContext}\n        url={request.url}\n        abortDelay={ABORT_DELAY}\n      />,\n      {\n        onShellReady() {\n          shellRendered = true;\n          const body = new PassThrough();\n          const stream = createReadableStreamFromReadable(body);\n\n          responseHeaders.set(\"Content-Type\", \"text/html\");\n\n          resolve(\n            new Response(stream, {\n              headers: responseHeaders,\n              status: responseStatusCode,\n            })\n          );\n\n          pipe(body);\n        },\n        onShellError(error: unknown) {\n          reject(error);\n        },\n        onError(error: unknown) {\n          responseStatusCode = 500;\n          // Log streaming rendering errors from inside the shell.  Don't log\n          // errors encountered during initial shell rendering since they'll\n          // reject and get logged in handleDocumentRequest.\n          if (shellRendered) {\n            console.error(error);\n          }\n        },\n      }\n    );\n\n    setTimeout(abort, ABORT_DELAY);\n  });\n}\n", "import {\n  Links,\n  LiveReload,\n  Meta,\n  Outlet,\n  Scripts,\n  ScrollRestoration } from\n\"@remix-run/react\";\nimport type { MetaFunction } from \"@remix-run/node\";\nimport { AppProvider } from \"@shopify/polaris\";\nimport \"@shopify/polaris/build/esm/styles.css?__remix_sideEffect__\";\n\nexport const meta: MetaFunction = () => [\n{ charset: \"utf-8\" },\n{ title: \"TurnApp Admin\" },\n{ name: \"viewport\", content: \"width=device-width,initial-scale=1\" }];\n\n\nexport default function App() {\n  return (\n    <html lang=\"en\">\n      <head>\n        <Meta />\n        <Links />\n      </head>\n      <body>\n        <AppProvider i18n={{}} theme=\"light\">\n          <Outlet />\n        </AppProvider>\n        <ScrollRestoration />\n        <Scripts />\n        <LiveReload />\n      </body>\n    </html>);\n\n}", "import { json, type ActionFunctionArgs } from \"@remix-run/node\";\nimport { verifyWebhookHmac } from \"~/lib/webhooks.server\";\nimport { prisma } from \"~/lib/prisma.server\";\n\nexport async function action({ request }: ActionFunctionArgs) {\n  if (request.method !== \"POST\") {\n    return json({ error: \"Method not allowed\" }, { status: 405 });\n  }\n\n  const hmacHeader = request.headers.get(\"X-Shopify-Hmac-Sha256\");\n  const shopDomain = request.headers.get(\"X-Shopify-Shop-Domain\");\n  \n  if (!hmacHeader || !shopDomain) {\n    console.error(\"Missing required webhook headers\");\n    return json({ error: \"Missing headers\" }, { status: 400 });\n  }\n\n  // Get raw body for HMAC verification\n  const body = await request.text();\n  \n  // Verify HMAC signature\n  const apiSecret = process.env.SHOPIFY_API_SECRET;\n  if (!apiSecret) {\n    console.error(\"Missing Shopify API secret\");\n    return json({ error: \"Server configuration error\" }, { status: 500 });\n  }\n\n  if (!verifyWebhookHmac(body, hmacHeader, apiSecret)) {\n    console.error(\"Webhook HMAC verification failed for shop:\", shopDomain);\n    return json({ error: \"Invalid signature\" }, { status: 403 });\n  }\n\n  try {\n    // Parse webhook payload\n    const payload = JSON.parse(body);\n    console.log(\"App uninstalled webhook received:\", { \n      shop: shopDomain,\n      domain: payload.domain,\n      timestamp: new Date().toISOString()\n    });\n\n    // Soft delete shop record (set uninstalledAt timestamp)\n    const updatedShop = await prisma.shop.update({\n      where: { shopDomain },\n      data: { \n        uninstalledAt: new Date(),\n        // Keep the record for potential re-installation\n        // accessTokenEnc will be overwritten on re-install\n      }\n    });\n\n    console.log(\"Shop uninstalled successfully:\", { \n      shopDomain,\n      installedAt: updatedShop.installedAt,\n      uninstalledAt: updatedShop.uninstalledAt\n    });\n\n    // Respond quickly to Shopify\n    return json({ status: \"ok\" }, { status: 200 });\n\n  } catch (error) {\n    console.error(\"Error processing app uninstall webhook:\", error);\n    \n    // Still return 200 to prevent retries for malformed payloads\n    if (error instanceof SyntaxError) {\n      return json({ status: \"ok\" }, { status: 200 });\n    }\n    \n    // For database errors, return 500 so Shopify retries\n    return json({ error: \"Internal error\" }, { status: 500 });\n  }\n}", "import { createHmac } from \"node:crypto\";\n\nexport function verifyWebhookHmac(\n  body: string | Buffer, \n  hmacHeader: string,\n  secret: string\n): boolean {\n  const bodyString = typeof body === 'string' ? body : body.toString('utf8');\n  const calculatedHmac = createHmac('sha256', secret)\n    .update(bodyString, 'utf8')\n    .digest('base64');\n  \n  const providedHmac = hmacHeader.replace('sha256=', '');\n  \n  // Use timingSafeEqual to prevent timing attacks\n  return timingSafeEqual(\n    Buffer.from(calculatedHmac, 'base64'),\n    Buffer.from(providedHmac, 'base64')\n  );\n}\n\nfunction timingSafeEqual(a: Buffer, b: Buffer): boolean {\n  if (a.length !== b.length) {\n    return false;\n  }\n  \n  let result = 0;\n  for (let i = 0; i < a.length; i++) {\n    result |= a[i] ^ b[i];\n  }\n  \n  return result === 0;\n}\n\nexport interface WebhookRegistration {\n  topic: string;\n  address: string;\n  format: 'json';\n}\n\nexport async function registerWebhooks(\n  shop: string,\n  accessToken: string,\n  baseUrl: string\n): Promise<void> {\n  const webhooks: WebhookRegistration[] = [\n    {\n      topic: 'app/uninstalled',\n      address: `${baseUrl}/webhooks/app_uninstalled`,\n      format: 'json'\n    },\n    {\n      topic: 'products/update',\n      address: `${baseUrl}/webhooks/products_update`, \n      format: 'json'\n    }\n  ];\n\n  for (const webhook of webhooks) {\n    try {\n      const response = await fetch(`https://${shop}/admin/api/2024-01/webhooks.json`, {\n        method: 'POST',\n        headers: {\n          'Content-Type': 'application/json',\n          'X-Shopify-Access-Token': accessToken,\n        },\n        body: JSON.stringify({ webhook })\n      });\n\n      if (response.ok) {\n        const result = await response.json();\n        console.log(`Webhook registered: ${webhook.topic}`, result.webhook?.id);\n      } else {\n        const error = await response.text();\n        console.error(`Failed to register webhook ${webhook.topic}:`, error);\n      }\n    } catch (error) {\n      console.error(`Error registering webhook ${webhook.topic}:`, error);\n    }\n  }\n}\n\nexport async function unregisterWebhooks(\n  shop: string,\n  accessToken: string\n): Promise<void> {\n  try {\n    // Get all webhooks for this app\n    const response = await fetch(`https://${shop}/admin/api/2024-01/webhooks.json`, {\n      headers: {\n        'X-Shopify-Access-Token': accessToken,\n      }\n    });\n\n    if (response.ok) {\n      const data = await response.json();\n      const webhooks = data.webhooks || [];\n      \n      // Delete each webhook\n      for (const webhook of webhooks) {\n        await fetch(`https://${shop}/admin/api/2024-01/webhooks/${webhook.id}.json`, {\n          method: 'DELETE',\n          headers: {\n            'X-Shopify-Access-Token': accessToken,\n          }\n        });\n        console.log(`Webhook unregistered: ${webhook.topic} (${webhook.id})`);\n      }\n    }\n  } catch (error) {\n    console.error('Error unregistering webhooks:', error);\n  }\n}", "import { PrismaClient } from '@prisma/client';\n\ndeclare global {\n  var __db__: PrismaClient;\n}\n\nlet prisma: PrismaClient;\n\nif (process.env.NODE_ENV === 'production') {\n  prisma = new PrismaClient();\n} else {\n  if (!global.__db__) {\n    global.__db__ = new PrismaClient();\n  }\n  prisma = global.__db__;\n  prisma.$connect();\n}\n\nexport { prisma };", "import { json, type ActionFunctionArgs } from \"@remix-run/node\";\nimport { verifyWebhookHmac } from \"~/lib/webhooks.server\";\n\nexport async function action({ request }: ActionFunctionArgs) {\n  if (request.method !== \"POST\") {\n    return json({ error: \"Method not allowed\" }, { status: 405 });\n  }\n\n  const hmacHeader = request.headers.get(\"X-Shopify-Hmac-Sha256\");\n  const shopDomain = request.headers.get(\"X-Shopify-Shop-Domain\");\n  \n  if (!hmacHeader || !shopDomain) {\n    console.error(\"Missing required webhook headers\");\n    return json({ error: \"Missing headers\" }, { status: 400 });\n  }\n\n  // Get raw body for HMAC verification\n  const body = await request.text();\n  \n  // Verify HMAC signature\n  const apiSecret = process.env.SHOPIFY_API_SECRET;\n  if (!apiSecret) {\n    console.error(\"Missing Shopify API secret\");\n    return json({ error: \"Server configuration error\" }, { status: 500 });\n  }\n\n  if (!verifyWebhookHmac(body, hmacHeader, apiSecret)) {\n    console.error(\"Webhook HMAC verification failed for shop:\", shopDomain);\n    return json({ error: \"Invalid signature\" }, { status: 403 });\n  }\n\n  try {\n    // Parse webhook payload\n    const payload = JSON.parse(body);\n    console.log(\"Product updated webhook received:\", { \n      shop: shopDomain,\n      productId: payload.id,\n      productTitle: payload.title,\n      updatedAt: payload.updated_at,\n      timestamp: new Date().toISOString()\n    });\n\n    // TODO: Implement cache invalidation\n    // For MVP, we just log the event\n    // In future iterations:\n    // - Invalidate product cache entries\n    // - Trigger mobile app notifications\n    // - Update search indices\n\n    console.log(\"Product cache invalidated for shop:\", shopDomain);\n\n    // Respond quickly to Shopify\n    return json({ status: \"ok\" }, { status: 200 });\n\n  } catch (error) {\n    console.error(\"Error processing products update webhook:\", error);\n    \n    // Still return 200 to prevent retries for malformed payloads\n    if (error instanceof SyntaxError) {\n      return json({ status: \"ok\" }, { status: 200 });\n    }\n    \n    // For future cache errors, return 500 so Shopify retries\n    return json({ error: \"Internal error\" }, { status: 500 });\n  }\n}", "import { json, type LoaderFunctionArgs, type ActionFunctionArgs } from \"@remix-run/node\";\nimport { useLoaderData, Form, useActionData } from \"@remix-run/react\";\nimport { getOptionalSession } from \"~/lib/session.server\";\nimport {\n  Page,\n  Layout,\n  Card,\n  FormLayout,\n  TextField,\n  Button,\n  Banner,\n  Text,\n  Divider,\n  InlineStack\n} from \"@shopify/polaris\";\nimport { useState, useCallback } from \"react\";\n\nexport async function loader({ request }: LoaderFunctionArgs) {\n  // Try session token first (for embedded admin)\n  const sessionContext = await getOptionalSession(request);\n  \n  let shop: string;\n  if (sessionContext) {\n    shop = sessionContext.shop;\n  } else {\n    // Fallback to query parameter (for development/testing)\n    const shopParam = new URL(request.url).searchParams.get(\"shop\");\n    if (!shopParam) {\n      throw new Response(\"Unauthorized - Missing session token or shop parameter\", { status: 401 });\n    }\n    shop = shopParam;\n  }\n\n  // Load branding settings from config API\n  try {\n    const configUrl = new URL(\"/api/config\", request.url);\n    configUrl.searchParams.set(\"shop\", shop);\n    \n    const configResponse = await fetch(configUrl.toString());\n    const configData = await configResponse.json();\n    \n    if (!configResponse.ok) {\n      throw new Error(configData.error || \"Failed to load config\");\n    }\n\n    return json({\n      shop,\n      brandingSettings: configData.branding\n    });\n  } catch (error) {\n    console.error(\"Failed to load branding settings:\", error);\n    \n    // Fallback to defaults\n    const brandingSettings = {\n      brandName: shop.split('.')[0],\n      primaryColor: \"#007C3B\",\n      logoUrl: \"\",\n      tagline: \"Your mobile shopping experience\"\n    };\n\n    return json({\n      shop,\n      brandingSettings\n    });\n  }\n}\n\nexport async function action({ request }: ActionFunctionArgs) {\n  // Try session token first (for embedded admin)\n  const sessionContext = await getOptionalSession(request);\n  \n  let shop: string;\n  if (sessionContext) {\n    shop = sessionContext.shop;\n  } else {\n    // Fallback to query parameter (for development/testing)\n    const shopParam = new URL(request.url).searchParams.get(\"shop\");\n    if (!shopParam) {\n      throw new Response(\"Unauthorized - Missing session token or shop parameter\", { status: 401 });\n    }\n    shop = shopParam;\n  }\n\n  try {\n    // Forward to settings API\n    const settingsUrl = new URL(\"/api/settings\", request.url);\n    settingsUrl.searchParams.set(\"shop\", shop);\n    \n    const formData = await request.formData();\n    \n    const settingsResponse = await fetch(settingsUrl.toString(), {\n      method: \"POST\",\n      body: formData\n    });\n    \n    const settingsData = await settingsResponse.json();\n    \n    if (!settingsResponse.ok) {\n      throw new Error(settingsData.error || \"Failed to save settings\");\n    }\n\n    return json(settingsData);\n    \n  } catch (error) {\n    console.error(\"Failed to save branding settings:\", error);\n    return json({\n      error: error instanceof Error ? error.message : \"Failed to save settings\"\n    }, { status: 500 });\n  }\n}\n\nexport default function AdminBranding() {\n  const { shop, brandingSettings } = useLoaderData<typeof loader>();\n  const actionData = useActionData<typeof action>();\n  \n  const [brandName, setBrandName] = useState(brandingSettings.brandName);\n  const [primaryColor, setPrimaryColor] = useState(brandingSettings.primaryColor);\n  const [logoUrl, setLogoUrl] = useState(brandingSettings.logoUrl);\n  const [tagline, setTagline] = useState(brandingSettings.tagline);\n\n  const handleBrandNameChange = useCallback((value: string) => setBrandName(value), []);\n  const handleLogoUrlChange = useCallback((value: string) => setLogoUrl(value), []);\n  const handleTaglineChange = useCallback((value: string) => setTagline(value), []);\n\n  return (\n    <Page \n      title=\"Branding Configuration\"\n      subtitle=\"Customize your mobile app appearance\"\n      backAction={{\n        url: '/admin'\n      }}\n    >\n      <Layout>\n        <Layout.Section>\n          {actionData?.success && (\n            <Banner tone=\"success\" onDismiss={() => {}}>\n              {actionData.message}\n            </Banner>\n          )}\n          {actionData?.error && (\n            <Banner tone=\"critical\" onDismiss={() => {}}>\n              {actionData.error}\n            </Banner>\n          )}\n          \n          <Card>\n            <Form method=\"post\">\n              <FormLayout>\n                <Text variant=\"headingSm\" as=\"h3\">Basic Information</Text>\n                \n                <TextField\n                  label=\"App Name\"\n                  value={brandName}\n                  onChange={handleBrandNameChange}\n                  name=\"brandName\"\n                  helpText=\"This will be the name of your mobile app\"\n                  autoComplete=\"off\"\n                />\n\n                <TextField\n                  label=\"Tagline\"\n                  value={tagline}\n                  onChange={handleTaglineChange}\n                  name=\"tagline\"\n                  helpText=\"A short description for your mobile app\"\n                  autoComplete=\"off\"\n                />\n\n                <Divider />\n\n                <Text variant=\"headingSm\" as=\"h3\">Visual Design</Text>\n\n                <TextField\n                  label=\"Primary Color\"\n                  value={primaryColor}\n                  onChange={setPrimaryColor}\n                  name=\"primaryColor\"\n                  helpText=\"Hex color code for your app's primary color\"\n                  autoComplete=\"off\"\n                  prefix=\"#\"\n                  placeholder=\"007C3B\"\n                />\n\n                <TextField\n                  label=\"Logo URL\"\n                  value={logoUrl}\n                  onChange={handleLogoUrlChange}\n                  name=\"logoUrl\"\n                  helpText=\"URL to your app logo (optional)\"\n                  autoComplete=\"off\"\n                />\n\n                <InlineStack align=\"end\">\n                  <Button variant=\"primary\" submit>\n                    Save Settings\n                  </Button>\n                </InlineStack>\n              </FormLayout>\n            </Form>\n          </Card>\n        </Layout.Section>\n\n        <Layout.Section variant=\"oneThird\">\n          <Card>\n            <div style={{ padding: '20px' }}>\n              <Text variant=\"headingSm\" as=\"h3\">Preview</Text>\n              <div style={{ marginTop: '16px' }}>\n                <div \n                  style={{\n                    padding: '20px',\n                    backgroundColor: primaryColor,\n                    color: 'white',\n                    borderRadius: '8px',\n                    textAlign: 'center'\n                  }}\n                >\n                  <Text variant=\"headingLg\" as=\"h2\">\n                    {brandName || 'Your App Name'}\n                  </Text>\n                  <Text variant=\"bodyMd\" as=\"p\">\n                    {tagline || 'Your tagline here'}\n                  </Text>\n                </div>\n              </div>\n            </div>\n          </Card>\n        </Layout.Section>\n      </Layout>\n    </Page>\n  );\n}", "import { createHmac } from \"node:crypto\";\n\nexport interface ShopifySessionToken {\n  iss: string;  // Shop domain\n  dest: string; // Shop domain  \n  aud: string;  // API key\n  sub: string;  // User ID\n  exp: number;  // Expiration\n  nbf: number;  // Not before\n  iat: number;  // Issued at\n  jti: string;  // JWT ID\n  sid: string;  // Session ID\n}\n\n/**\n * Simple JWT decoder (without full verification for MVP)\n */\nfunction decodeJWT(token: string): any {\n  try {\n    const parts = token.split('.');\n    if (parts.length !== 3) {\n      throw new Error('Invalid JWT format');\n    }\n\n    // Decode payload (second part)\n    const payload = parts[1];\n    const decoded = Buffer.from(payload, 'base64url').toString('utf8');\n    return JSON.parse(decoded);\n  } catch (error) {\n    console.error('JWT decode failed:', error);\n    return null;\n  }\n}\n\n/**\n * Verify Shopify session token signature\n */\nfunction verifyJWTSignature(token: string, secret: string): boolean {\n  try {\n    const parts = token.split('.');\n    if (parts.length !== 3) return false;\n\n    const [header, payload, signature] = parts;\n    \n    // Recreate signature\n    const data = `${header}.${payload}`;\n    const expectedSignature = createHmac('sha256', secret)\n      .update(data)\n      .digest('base64url');\n\n    return signature === expectedSignature;\n  } catch (error) {\n    console.error('JWT signature verification failed:', error);\n    return false;\n  }\n}\n\n/**\n * Verify and decode Shopify session token from embedded admin\n */\nexport function verifySessionToken(token: string): ShopifySessionToken | null {\n  try {\n    const apiSecret = process.env.SHOPIFY_API_SECRET;\n    if (!apiSecret) {\n      console.error(\"Missing SHOPIFY_API_SECRET\");\n      return null;\n    }\n\n    // Verify signature\n    if (!verifyJWTSignature(token, apiSecret)) {\n      console.error(\"Session token signature verification failed\");\n      return null;\n    }\n\n    // Decode payload\n    const decoded = decodeJWT(token);\n    if (!decoded) {\n      return null;\n    }\n\n    // Validate required fields\n    if (!decoded.iss || !decoded.dest || !decoded.aud) {\n      console.error(\"Invalid session token: missing required fields\");\n      return null;\n    }\n\n    // Ensure shop domains match\n    if (decoded.iss !== decoded.dest) {\n      console.error(\"Session token: iss and dest don't match\");\n      return null;\n    }\n\n    // Check expiration\n    if (decoded.exp && decoded.exp < Math.floor(Date.now() / 1000)) {\n      console.error(\"Session token expired\");\n      return null;\n    }\n\n    return decoded as ShopifySessionToken;\n\n  } catch (error) {\n    console.error(\"Session token verification failed:\", error);\n    return null;\n  }\n}\n\n/**\n * Extract shop domain from session token\n */\nexport function getShopFromSession(token: string): string | null {\n  const session = verifySessionToken(token);\n  return session ? session.iss : null;\n}\n\n/**\n * Middleware to verify session token and add shop context\n */\nexport function createSessionMiddleware() {\n  return async (request: Request): Promise<{ shop: string; session: ShopifySessionToken } | null> => {\n    const sessionTokenHeader = request.headers.get(\"X-Shopify-Session-Token\");\n    \n    if (!sessionTokenHeader) {\n      return null;\n    }\n\n    const session = verifySessionToken(sessionTokenHeader);\n    if (!session) {\n      return null;\n    }\n\n    return {\n      shop: session.iss,\n      session\n    };\n  };\n}\n\n/**\n * Extract session context from request - for use in loaders/actions\n */\nexport async function requireValidSession(request: Request): Promise<{ shop: string; session: ShopifySessionToken }> {\n  const middleware = createSessionMiddleware();\n  const context = await middleware(request);\n  \n  if (!context) {\n    throw new Response(\"Unauthorized - Invalid or missing session token\", { \n      status: 401,\n      headers: {\n        'Content-Type': 'application/json'\n      }\n    });\n  }\n\n  return context;\n}\n\n/**\n * Optional session context - returns null if no valid session\n */\nexport async function getOptionalSession(request: Request): Promise<{ shop: string; session: ShopifySessionToken } | null> {\n  const middleware = createSessionMiddleware();\n  return await middleware(request);\n}", "import { redirect, type LoaderFunctionArgs } from \"@remix-run/node\";\nimport { \n  verifyShopifyHmac, \n  exchangeCodeForToken \n} from \"~/lib/shopify-auth.server\";\nimport { prisma } from \"~/lib/prisma.server\";\nimport { registerWebhooks } from \"~/lib/webhooks.server\";\nimport { encryptToken } from \"~/lib/crypto.server\";\nimport { getShopWithToken } from \"~/lib/shop.server\";\n\nexport async function loader({ request }: LoaderFunctionArgs) {\n  const url = new URL(request.url);\n  const queryParams = Object.fromEntries(url.searchParams.entries());\n  \n  const { shop, code, hmac, state } = queryParams;\n\n  // Validate required parameters\n  if (!shop || !code || !hmac) {\n    throw new Response('Missing required OAuth parameters', { status: 400 });\n  }\n\n  // Validate shop domain\n  const shopDomain = shop.replace(/^https?:\\/\\//, '').replace(/\\/$/, '');\n  if (!/^[a-zA-Z0-9]([a-zA-Z0-9-]*[a-zA-Z0-9])?\\.myshopify\\.com$/.test(shopDomain)) {\n    throw new Response('Invalid shop domain', { status: 400 });\n  }\n\n  // Verify HMAC signature\n  const apiSecret = process.env.SHOPIFY_API_SECRET;\n  if (!apiSecret) {\n    throw new Response('Missing Shopify API secret', { status: 500 });\n  }\n\n  if (!verifyShopifyHmac(url.searchParams, apiSecret)) {\n    console.error('HMAC verification failed for shop:', shopDomain);\n    throw new Response('Invalid HMAC signature', { status: 403 });\n  }\n\n  // Exchange code for access token\n  const apiKey = process.env.SHOPIFY_API_KEY;\n  if (!apiKey) {\n    throw new Response('Missing Shopify API key', { status: 500 });\n  }\n\n  const tokenData = await exchangeCodeForToken(\n    shopDomain,\n    code,\n    apiKey,\n    apiSecret\n  );\n\n  if (!tokenData) {\n    throw new Response('Failed to exchange OAuth code for token', { status: 400 });\n  }\n\n  try {\n    // Encrypt access token before storing\n    const encryptedToken = encryptToken(tokenData.access_token);\n    \n    // Store shop and encrypted token in database\n    await prisma.shop.upsert({\n      where: { shopDomain },\n      update: {\n        accessTokenEnc: encryptedToken,\n        uninstalledAt: null, // Clear uninstall timestamp if re-installing\n        updatedAt: new Date(),\n      },\n      create: {\n        shopDomain,\n        accessTokenEnc: encryptedToken,\n        installedAt: new Date(),\n        settings: JSON.stringify({}),\n      },\n    });\n\n    console.log('Shop installed successfully:', shopDomain);\n\n    // Register webhooks after successful installation\n    const baseUrl = new URL(request.url).origin;\n    const shopWithToken = await getShopWithToken(shopDomain);\n    if (shopWithToken) {\n      await registerWebhooks(shopDomain, shopWithToken.accessToken, baseUrl);\n    }\n    \n    // Redirect to admin dashboard\n    return redirect(`https://${shopDomain}/admin/apps/${apiKey}`);\n    \n  } catch (error) {\n    console.error('Database error during OAuth callback:', error);\n    throw new Response('Internal server error', { status: 500 });\n  }\n}", "import { createHmac, timingSafeEqual } from 'crypto';\n\n/**\n * Verifies HMAC signature from Shopify\n * Used for OAuth callbacks and webhook validation\n */\nexport function verifyShopifyHmac(\n  query: URLSearchParams | Record<string, string>,\n  secret: string\n): boolean {\n  try {\n    const params = query instanceof URLSearchParams ? query : new URLSearchParams(query);\n    const hmac = params.get('hmac');\n    \n    if (!hmac) {\n      return false;\n    }\n\n    // Remove hmac and signature from query params\n    params.delete('hmac');\n    params.delete('signature');\n\n    // Sort parameters and create query string\n    const sortedParams = Array.from(params.entries())\n      .sort(([a], [b]) => a.localeCompare(b))\n      .map(([key, value]) => `${key}=${value}`)\n      .join('&');\n\n    // Calculate expected HMAC\n    const expectedHmac = createHmac('sha256', secret)\n      .update(sortedParams)\n      .digest('hex');\n\n    // Validate HMAC length before comparison\n    if (hmac.length !== expectedHmac.length) {\n      return false;\n    }\n\n    // Timing-safe comparison\n    return timingSafeEqual(\n      Buffer.from(hmac, 'hex'),\n      Buffer.from(expectedHmac, 'hex')\n    );\n  } catch (error) {\n    console.error('HMAC verification error:', error);\n    return false;\n  }\n}\n\n/**\n * Verifies webhook HMAC from X-Shopify-Hmac-Sha256 header\n */\nexport function verifyWebhookHmac(\n  body: string,\n  hmacHeader: string,\n  secret: string\n): boolean {\n  try {\n    const expectedHmac = createHmac('sha256', secret)\n      .update(body, 'utf8')\n      .digest('base64');\n\n    // Validate HMAC length before comparison\n    if (hmacHeader.length !== expectedHmac.length) {\n      return false;\n    }\n\n    return timingSafeEqual(\n      Buffer.from(hmacHeader, 'base64'),\n      Buffer.from(expectedHmac, 'base64')\n    );\n  } catch (error) {\n    console.error('Webhook HMAC verification error:', error);\n    return false;\n  }\n}\n\n/**\n * Creates OAuth authorization URL\n */\nexport function createOAuthUrl(\n  shop: string,\n  apiKey: string,\n  scopes: string,\n  redirectUri: string\n): string {\n  const params = new URLSearchParams({\n    client_id: apiKey,\n    scope: scopes,\n    redirect_uri: redirectUri,\n    state: createNonce(), // CSRF protection\n  });\n\n  return `https://${shop}.myshopify.com/admin/oauth/authorize?${params.toString()}`;\n}\n\n/**\n * Exchanges OAuth code for access token\n */\nexport async function exchangeCodeForToken(\n  shop: string,\n  code: string,\n  apiKey: string,\n  apiSecret: string\n): Promise<{ access_token: string; scope: string } | null> {\n  try {\n    const response = await fetch(`https://${shop}.myshopify.com/admin/oauth/access_token`, {\n      method: 'POST',\n      headers: {\n        'Content-Type': 'application/json',\n      },\n      body: JSON.stringify({\n        client_id: apiKey,\n        client_secret: apiSecret,\n        code,\n      }),\n    });\n\n    if (!response.ok) {\n      console.error('Token exchange failed:', response.status, response.statusText);\n      return null;\n    }\n\n    return await response.json();\n  } catch (error) {\n    console.error('Token exchange error:', error);\n    return null;\n  }\n}\n\n/**\n * Creates a random nonce for CSRF protection\n */\nfunction createNonce(): string {\n  return Math.random().toString(36).substring(2, 15) + \n         Math.random().toString(36).substring(2, 15);\n}", "import { randomBytes, createCipheriv, createDecipheriv, pbkdf2Sync, createHmac } from \"node:crypto\";\n\nconst ALGORITHM = 'aes-256-cbc';\nconst IV_LENGTH = 16; // 128 bit\nconst KEY_LENGTH = 32; // 256 bit\nconst HMAC_LENGTH = 32; // 256 bit\n\n/**\n * Get or derive encryption key from environment\n */\nfunction getEncryptionKey(): Buffer {\n  const envKey = process.env.ENCRYPTION_KEY;\n  \n  if (envKey) {\n    // Production: Use provided key directly or derive from it\n    if (envKey.length === 64) {\n      // Assume it's already a hex-encoded 256-bit key\n      return Buffer.from(envKey, 'hex');\n    } else {\n      // Derive key from passphrase using PBKDF2\n      const salt = Buffer.from('turnapp-static-salt-v1', 'utf8'); // Static salt for deterministic key\n      return pbkdf2Sync(envKey, salt, 100000, KEY_LENGTH, 'sha256');\n    }\n  }\n  \n  // Development: Generate deterministic key from NODE_ENV and app name\n  const fallbackSeed = `${process.env.NODE_ENV || 'development'}-turnapp-dev-key-v1`;\n  const salt = Buffer.from('dev-salt-turnapp', 'utf8');\n  return pbkdf2Sync(fallbackSeed, salt, 10000, KEY_LENGTH, 'sha256');\n}\n\n/**\n * Encrypt sensitive data (like access tokens) for storage\n */\nexport function encryptToken(plaintext: string): string {\n  if (!plaintext || plaintext.length === 0) {\n    throw new Error('Cannot encrypt empty token');\n  }\n  \n  try {\n    const key = getEncryptionKey();\n    const iv = randomBytes(IV_LENGTH);\n    \n    const cipher = createCipheriv(ALGORITHM, key, iv);\n    \n    let encrypted = cipher.update(plaintext, 'utf8', 'hex');\n    encrypted += cipher.final('hex');\n    \n    // Create HMAC for integrity\n    const hmac = createHmac('sha256', key);\n    hmac.update(iv);\n    hmac.update(Buffer.from(encrypted, 'hex'));\n    const authTag = hmac.digest();\n    \n    // Format: iv(32hex) + encrypted(variable) + hmac(64hex)\n    return iv.toString('hex') + encrypted + authTag.toString('hex');\n    \n  } catch (error) {\n    console.error('Encryption failed:', error);\n    throw new Error('Failed to encrypt token');\n  }\n}\n\n/**\n * Decrypt sensitive data from storage\n */\nexport function decryptToken(ciphertext: string): string {\n  try {\n    // Parse components: iv(32hex) + encrypted + hmac(64hex)\n    if (ciphertext.length < IV_LENGTH * 2 + HMAC_LENGTH * 2) {\n      throw new Error('Invalid ciphertext format');\n    }\n    \n    const ivHex = ciphertext.substring(0, IV_LENGTH * 2);\n    const hmacHex = ciphertext.substring(ciphertext.length - HMAC_LENGTH * 2);\n    const encryptedHex = ciphertext.substring(IV_LENGTH * 2, ciphertext.length - HMAC_LENGTH * 2);\n    \n    const iv = Buffer.from(ivHex, 'hex');\n    const providedHmac = Buffer.from(hmacHex, 'hex');\n    const encrypted = Buffer.from(encryptedHex, 'hex');\n    \n    const key = getEncryptionKey();\n    \n    // Verify HMAC\n    const hmac = createHmac('sha256', key);\n    hmac.update(iv);\n    hmac.update(encrypted);\n    const calculatedHmac = hmac.digest();\n    \n    if (!calculatedHmac.equals(providedHmac)) {\n      throw new Error('Token integrity check failed');\n    }\n    \n    const decipher = createDecipheriv(ALGORITHM, key, iv);\n    \n    let decrypted = decipher.update(encryptedHex, 'hex', 'utf8');\n    decrypted += decipher.final('utf8');\n    \n    return decrypted;\n    \n  } catch (error) {\n    console.error('Decryption failed:', error);\n    throw new Error('Failed to decrypt token');\n  }\n}\n\n/**\n * Test encryption/decryption roundtrip\n */\nexport function testCrypto(): boolean {\n  try {\n    const testData = 'test-access-token-12345';\n    const encrypted = encryptToken(testData);\n    const decrypted = decryptToken(encrypted);\n    \n    return testData === decrypted;\n  } catch (error) {\n    console.error('Crypto test failed:', error);\n    return false;\n  }\n}\n\n/**\n * Generate a new encryption key (for production setup)\n */\nexport function generateEncryptionKey(): string {\n  return randomBytes(KEY_LENGTH).toString('hex');\n}", "import { prisma } from \"~/lib/prisma.server\";\nimport { decryptToken } from \"~/lib/crypto.server\";\n\nexport interface ShopWithToken {\n  shopDomain: string;\n  accessToken: string;\n  installedAt: Date;\n  uninstalledAt: Date | null;\n  settings: any;\n}\n\n/**\n * Get shop with decrypted access token for API calls\n */\nexport async function getShopWithToken(shopDomain: string): Promise<ShopWithToken | null> {\n  try {\n    const shop = await prisma.shop.findUnique({\n      where: { shopDomain }\n    });\n\n    if (!shop || shop.uninstalledAt) {\n      return null;\n    }\n\n    // Decrypt the access token\n    const accessToken = decryptToken(shop.accessTokenEnc);\n\n    return {\n      shopDomain: shop.shopDomain,\n      accessToken,\n      installedAt: shop.installedAt,\n      uninstalledAt: shop.uninstalledAt,\n      settings: shop.settings ? JSON.parse(shop.settings) : {}\n    };\n  } catch (error) {\n    console.error('Failed to get shop with token:', error);\n    return null;\n  }\n}\n\n/**\n * Check if shop is installed and active\n */\nexport async function isShopActive(shopDomain: string): Promise<boolean> {\n  try {\n    const shop = await prisma.shop.findUnique({\n      where: { shopDomain },\n      select: { uninstalledAt: true }\n    });\n\n    return shop ? !shop.uninstalledAt : false;\n  } catch (error) {\n    console.error('Failed to check shop status:', error);\n    return false;\n  }\n}\n\n/**\n * Get shop settings without decrypting token\n */\nexport async function getShopSettings(shopDomain: string): Promise<any | null> {\n  try {\n    const shop = await prisma.shop.findUnique({\n      where: { shopDomain },\n      select: { settings: true, uninstalledAt: true }\n    });\n\n    if (!shop || shop.uninstalledAt) {\n      return null;\n    }\n\n    return shop.settings ? JSON.parse(shop.settings) : {};\n  } catch (error) {\n    console.error('Failed to get shop settings:', error);\n    return null;\n  }\n}", "import { json, type ActionFunctionArgs } from \"@remix-run/node\";\nimport { prisma } from \"~/lib/prisma.server\";\nimport { BrandingSettingsSchema } from \"~/lib/validation.server\";\n\nexport async function action({ request }: ActionFunctionArgs) {\n  if (request.method !== \"POST\") {\n    return json({ error: \"Method not allowed\" }, { status: 405 });\n  }\n\n  const url = new URL(request.url);\n  const shop = url.searchParams.get(\"shop\");\n  \n  if (!shop) {\n    return json({ error: \"Shop parameter required\" }, { status: 400 });\n  }\n\n  try {\n    const formData = await request.formData();\n    \n    // Extract form data\n    const brandingData = {\n      brandName: formData.get(\"brandName\") as string,\n      primaryColor: formData.get(\"primaryColor\") as string,\n      logoUrl: formData.get(\"logoUrl\") as string || \"\",\n      tagline: formData.get(\"tagline\") as string || \"\"\n    };\n\n    // Validate with Zod\n    const validatedBranding = BrandingSettingsSchema.parse(brandingData);\n\n    // Find shop in database\n    const shopRecord = await prisma.shop.findUnique({\n      where: { shopDomain: shop }\n    });\n\n    if (!shopRecord) {\n      return json({ error: \"Shop not found\" }, { status: 404 });\n    }\n\n    // Merge with existing settings\n    const currentSettings = (shopRecord.settings as any) || {};\n    const updatedSettings = {\n      ...currentSettings,\n      ...validatedBranding,\n      updatedAt: new Date().toISOString()\n    };\n\n    // Update shop settings\n    await prisma.shop.update({\n      where: { shopDomain: shop },\n      data: { settings: updatedSettings }\n    });\n\n    console.log(`Updated branding settings for shop: ${shop}`, validatedBranding);\n\n    return json({\n      success: true,\n      message: \"Branding settings saved successfully!\",\n      branding: validatedBranding\n    });\n\n  } catch (error) {\n    console.error(\"Settings API error:\", error);\n    \n    if (error instanceof Error && error.name === \"ZodError\") {\n      return json({ \n        error: \"Validation failed\", \n        details: error.message \n      }, { status: 400 });\n    }\n\n    return json({ error: \"Internal server error\" }, { status: 500 });\n  }\n}", "import { z } from \"zod\";\n\nexport const BrandingSettingsSchema = z.object({\n  brandName: z.string().min(1, \"Brand name is required\").max(50, \"Brand name too long\"),\n  primaryColor: z.string().regex(/^#[0-9A-F]{6}$/i, \"Invalid hex color format\"),\n  logoUrl: z.string().url(\"Invalid URL\").optional().or(z.literal(\"\")),\n  tagline: z.string().max(100, \"Tagline too long\").optional().or(z.literal(\"\"))\n});\n\nexport const ConfigResponseSchema = z.object({\n  shop: z.string(),\n  branding: BrandingSettingsSchema,\n  storefrontEndpoint: z.string().url(),\n  appVersion: z.string()\n});\n\nexport type BrandingSettings = z.infer<typeof BrandingSettingsSchema>;\nexport type ConfigResponse = z.infer<typeof ConfigResponseSchema>;", "import { redirect, type LoaderFunctionArgs } from \"@remix-run/node\";\nimport { createOAuthUrl } from \"~/lib/shopify-auth.server\";\n\nexport async function loader({ request }: LoaderFunctionArgs) {\n  const url = new URL(request.url);\n  const shop = url.searchParams.get('shop');\n\n  if (!shop) {\n    throw new Response('Missing shop parameter', { status: 400 });\n  }\n\n  // Validate shop domain format\n  const shopDomain = shop.replace(/^https?:\\/\\//, '').replace(/\\/$/, '');\n  if (!/^[a-zA-Z0-9][a-zA-Z0-9-]*\\.myshopify\\.com$/.test(shopDomain)) {\n    throw new Response('Invalid shop domain', { status: 400 });\n  }\n\n  const apiKey = process.env.SHOPIFY_API_KEY;\n  const scopes = process.env.SCOPES;\n  const redirectUri = `${process.env.APP_URL}/auth/callback`;\n\n  if (!apiKey || !scopes) {\n    throw new Response('Missing Shopify configuration', { status: 500 });\n  }\n\n  const authUrl = createOAuthUrl(shopDomain, apiKey, scopes, redirectUri);\n  \n  return redirect(authUrl);\n}", "import { json, type LoaderFunctionArgs } from \"@remix-run/node\";\nimport { ConfigResponseSchema } from \"~/lib/validation.server\";\nimport { getShopSettings } from \"~/lib/shop.server\";\nimport { getOptionalSession } from \"~/lib/session.server\";\n\nexport async function loader({ request }: LoaderFunctionArgs) {\n  // Try session token first (for embedded admin)\n  const sessionContext = await getOptionalSession(request);\n  \n  let shop: string;\n  if (sessionContext) {\n    shop = sessionContext.shop;\n  } else {\n    // Fallback to query parameter (for development/testing and mobile)\n    const shopParam = new URL(request.url).searchParams.get(\"shop\");\n    if (!shopParam) {\n      return json({ error: \"Shop parameter or session token required\" }, { status: 400 });\n    }\n    shop = shopParam;\n  }\n\n  try {\n    // Get shop settings (without decrypting token)\n    const settings = await getShopSettings(shop);\n\n    if (!settings) {\n      return json({ error: \"Shop not found or not active\" }, { status: 404 });\n    }\n\n    // Parse settings or use defaults\n    const branding = {\n      brandName: settings.brandName || shop.split('.')[0],\n      primaryColor: settings.primaryColor || \"#007C3B\",\n      logoUrl: settings.logoUrl || \"\",\n      tagline: settings.tagline || \"Your mobile shopping experience\"\n    };\n\n    const configResponse = {\n      shop,\n      branding,\n      storefrontEndpoint: `https://${shop}/api/2024-01/graphql.json`,\n      appVersion: \"1.0.0\"\n    };\n\n    // Validate response schema\n    const validatedConfig = ConfigResponseSchema.parse(configResponse);\n\n    return json(validatedConfig, {\n      headers: {\n        \"Cache-Control\": \"public, max-age=300\", // 5 minutes cache\n        \"Content-Type\": \"application/json\"\n      }\n    });\n\n  } catch (error) {\n    console.error(\"Config API error:\", error);\n    return json({ error: \"Internal server error\" }, { status: 500 });\n  }\n}", "import { json } from \"@remix-run/node\";\nimport { useLoaderData, Link } from \"@remix-run/react\";\n\nexport async function loader() {\n  const testShop = \"zeytestshop\"; // From .shopify/project.json\n  const installUrl = `/auth/install?shop=${testShop}.myshopify.com`;\n  \n  return json({\n    testShop,\n    installUrl,\n    apiKey: process.env.SHOPIFY_API_KEY || 'NOT_SET',\n    appUrl: process.env.APP_URL || 'NOT_SET',\n  });\n}\n\nexport default function TestOAuth() {\n  const { testShop, installUrl, apiKey, appUrl } = useLoaderData<typeof loader>();\n\n  return (\n    <div style={{ fontFamily: \"system-ui, sans-serif\", lineHeight: \"1.8\", padding: \"20px\" }}>\n      <h1>OAuth Test Page</h1>\n      \n      <div style={{ marginBottom: \"20px\" }}>\n        <h3>Configuration:</h3>\n        <p>Test Shop: {testShop}.myshopify.com</p>\n        <p>API Key: {apiKey}</p>\n        <p>App URL: {appUrl}</p>\n      </div>\n\n      <div style={{ marginBottom: \"20px\" }}>\n        <h3>Test OAuth Flow:</h3>\n        <Link \n          to={installUrl}\n          style={{ \n            padding: \"10px 20px\", \n            backgroundColor: \"#007C3B\", \n            color: \"white\", \n            textDecoration: \"none\",\n            borderRadius: \"4px\" \n          }}\n        >\n          Install App to {testShop}.myshopify.com\n        </Link>\n      </div>\n\n      <div style={{ marginTop: \"20px\", fontSize: \"14px\", color: \"#666\" }}>\n        <p>\u26A0\uFE0F Make sure to:</p>\n        <ul>\n          <li>Set SHOPIFY_API_KEY and SHOPIFY_API_SECRET in .env</li>\n          <li>Update APP_URL with your ngrok URL</li>\n          <li>Add the callback URL to your Shopify Partner Dashboard</li>\n        </ul>\n      </div>\n    </div>\n  );\n}", "import type { LoaderFunctionArgs } from '@remix-run/node';\nimport { json } from '@remix-run/node';\nimport { prisma } from '~/lib/prisma.server';\nimport { testCrypto } from '~/lib/crypto.server';\n\nexport async function loader({ request }: LoaderFunctionArgs) {\n  try {\n    // Test database connection\n    const shopCount = await prisma.shop.count();\n    \n    // Test crypto functionality\n    const cryptoOk = testCrypto();\n    \n    const health = {\n      status: 'healthy',\n      timestamp: new Date().toISOString(),\n      database: {\n        connected: true,\n        shops: shopCount\n      },\n      crypto: {\n        working: cryptoOk\n      },\n      version: process.env.npm_package_version || 'unknown'\n    };\n    \n    return json(health, { \n      status: 200,\n      headers: {\n        'Cache-Control': 'no-cache, no-store, must-revalidate',\n      }\n    });\n    \n  } catch (error) {\n    console.error('Health check failed:', error);\n    \n    return json({\n      status: 'unhealthy',\n      timestamp: new Date().toISOString(),\n      error: error instanceof Error ? error.message : 'Unknown error'\n    }, { \n      status: 503,\n      headers: {\n        'Cache-Control': 'no-cache, no-store, must-revalidate',\n      }\n    });\n  }\n}", "import { json } from \"@remix-run/node\";\nimport { useLoaderData, Link } from \"@remix-run/react\";\nimport { prisma } from \"~/lib/prisma.server\";\n\nexport async function loader() {\n  // Test DB connection\n  try {\n    await prisma.$queryRaw`SELECT 1`;\n    const shopCount = await prisma.shop.count();\n    const recentShops = await prisma.shop.findMany({\n      take: 5,\n      orderBy: { installedAt: 'desc' },\n      select: {\n        shopDomain: true,\n        installedAt: true,\n        uninstalledAt: true,\n      },\n    });\n    \n    return json({\n      message: \"TurnApp - Shopify App Admin Dashboard\",\n      timestamp: new Date().toISOString(),\n      dbStatus: \"connected\",\n      shopCount,\n      recentShops,\n    });\n  } catch (error) {\n    return json({\n      message: \"TurnApp - Shopify App Admin Dashboard\",\n      timestamp: new Date().toISOString(),\n      dbStatus: \"error\",\n      shopCount: 0,\n      recentShops: [],\n    });\n  }\n}\n\nexport default function Index() {\n  const { message, timestamp, dbStatus, shopCount, recentShops } = useLoaderData<typeof loader>();\n\n  return (\n    <div style={{ fontFamily: \"system-ui, sans-serif\", lineHeight: \"1.8\", padding: \"20px\" }}>\n      <h1>{message}</h1>\n      <p>Server Time: {timestamp}</p>\n      <p>Database Status: {dbStatus}</p>\n      <p>Registered Shops: {shopCount}</p>\n      <p>Status: OAuth Flow Implemented \u2705</p>\n      \n      <div style={{ marginTop: \"30px\" }}>\n        <h3>Development Tools:</h3>\n        <Link \n          to=\"/test/oauth\"\n          style={{ \n            padding: \"8px 16px\", \n            backgroundColor: \"#007C3B\", \n            color: \"white\", \n            textDecoration: \"none\",\n            borderRadius: \"4px\",\n            marginRight: \"10px\"\n          }}\n        >\n          Test OAuth Flow\n        </Link>\n      </div>\n\n      {recentShops.length > 0 && (\n        <div style={{ marginTop: \"30px\" }}>\n          <h3>Recent Shop Installations:</h3>\n          <ul>\n            {recentShops.map((shop) => (\n              <li key={shop.shopDomain}>\n                {shop.shopDomain} - \n                Installed: {new Date(shop.installedAt).toLocaleString()}\n                {shop.uninstalledAt && ` (Uninstalled: ${new Date(shop.uninstalledAt).toLocaleString()})`}\n              </li>\n            ))}\n          </ul>\n        </div>\n      )}\n    </div>\n  );\n}", "import { json, type LoaderFunctionArgs } from \"@remix-run/node\";\nimport { useLoaderData, Outlet, useLocation, Link } from \"@remix-run/react\";\nimport { getOptionalSession } from \"~/lib/session.server\";\nimport { \n  Frame, \n  TopBar, \n  Navigation, \n  Layout,\n  Page,\n  Text,\n  Card,\n  Button\n} from \"@shopify/polaris\";\nimport { useState, useCallback } from \"react\";\n// import AppBridge from \"@shopify/app-bridge-react\";\n// const { Provider } = AppBridge;\n\nexport async function loader({ request }: LoaderFunctionArgs) {\n  const url = new URL(request.url);\n  \n  // Try session token first (for embedded admin)\n  const sessionContext = await getOptionalSession(request);\n  \n  if (sessionContext) {\n    // Embedded admin with session token\n    return json({\n      shop: sessionContext.shop,\n      host: url.searchParams.get(\"host\"),\n      appBridgeConfig: {\n        apiKey: process.env.SHOPIFY_API_KEY || \"\",\n        shop: sessionContext.shop,\n        host: url.searchParams.get(\"host\") || \"\",\n      }\n    });\n  }\n  \n  // Fallback to query parameter (for development/testing)\n  const shop = url.searchParams.get(\"shop\");\n  const host = url.searchParams.get(\"host\");\n  \n  if (!shop) {\n    throw new Response(\"Unauthorized - Missing session token or shop parameter\", { status: 401 });\n  }\n\n  return json({\n    shop,\n    host,\n    appBridgeConfig: {\n      apiKey: process.env.SHOPIFY_API_KEY || \"\",\n      shop,\n      host: host || \"\",\n    }\n  });\n}\n\nexport default function AdminLayout() {\n  const { shop } = useLoaderData<typeof loader>();\n  const location = useLocation();\n  const [mobileNavigationActive, setMobileNavigationActive] = useState(false);\n\n  const toggleMobileNavigationActive = useCallback(\n    () => setMobileNavigationActive((mobileNavigationActive) => !mobileNavigationActive),\n    []\n  );\n\n  const navigationMarkup = (\n    <Navigation location={location.pathname}>\n      <Navigation.Section\n        items={[\n          {\n            url: '/admin',\n            label: 'Overview',\n            icon: 'HomeIcon' as any,\n            selected: location.pathname === '/admin'\n          },\n          {\n            url: '/admin/branding',\n            label: 'Branding',\n            icon: 'ColorIcon' as any,\n            selected: location.pathname === '/admin/branding'\n          }\n        ]}\n      />\n    </Navigation>\n  );\n\n  const topBarMarkup = (\n    <TopBar\n      showNavigationToggle\n      onNavigationToggle={toggleMobileNavigationActive}\n    />\n  );\n\n  const currentPath = location.pathname;\n  const isOverview = currentPath === '/admin' || currentPath === '/admin/';\n\n  return (\n    <Frame\n      topBar={topBarMarkup}\n      navigation={navigationMarkup}\n      showMobileNavigation={mobileNavigationActive}\n      onNavigationDismiss={toggleMobileNavigationActive}\n    >\n      {isOverview ? (\n        <Page title=\"TurnApp Overview\">\n          <Layout>\n            <Layout.Section>\n              <Card>\n                <div style={{ padding: '20px' }}>\n                  <Text variant=\"headingMd\" as=\"h2\">Welcome to TurnApp</Text>\n                  <Text variant=\"bodyMd\" as=\"p\" tone=\"subdued\">\n                    Transform your Shopify store into a mobile shopping app\n                  </Text>\n                  <div style={{ marginTop: '20px' }}>\n                    <Text variant=\"headingSm\" as=\"h3\">Shop: {shop}</Text>\n                  </div>\n                  <div style={{ marginTop: '20px' }}>\n                    <Link to=\"/admin/branding\">\n                      <Button variant=\"primary\">Configure Branding</Button>\n                    </Link>\n                  </div>\n                </div>\n              </Card>\n            </Layout.Section>\n            \n            <Layout.Section variant=\"oneThird\">\n              <Card>\n                <div style={{ padding: '20px' }}>\n                  <Text variant=\"headingSm\" as=\"h3\">Quick Stats</Text>\n                  <div style={{ marginTop: '12px' }}>\n                    <Text variant=\"bodyMd\" as=\"p\">Status: Active</Text>\n                    <Text variant=\"bodyMd\" as=\"p\">App Version: 1.0.0</Text>\n                  </div>\n                </div>\n              </Card>\n            </Layout.Section>\n          </Layout>\n        </Page>\n      ) : (\n        <Outlet />\n      )}\n    </Frame>\n  );\n}", "export default {'entry':{'module':'/build/entry.client-TBCJL747.js','imports':['/build/_shared/chunk-XC6BC2BP.js','/build/_shared/chunk-LW6LB2HF.js','/build/_shared/chunk-ALN5UVCC.js','/build/_shared/chunk-UWV35TSL.js','/build/_shared/chunk-PMI65YMG.js','/build/_shared/chunk-56LDNGDG.js','/build/_shared/chunk-2Q7FBYOG.js','/build/_shared/chunk-PNG5AS42.js']},'routes':{'root':{'id':'root','parentId':undefined,'path':'','index':undefined,'caseSensitive':undefined,'module':'/build/root-UYZEUWYC.js','imports':['/build/_shared/chunk-ANTKSAN7.js'],'hasAction':false,'hasLoader':false,'hasClientAction':false,'hasClientLoader':false,'hasErrorBoundary':false},'routes/_index':{'id':'routes/_index','parentId':'root','path':undefined,'index':true,'caseSensitive':undefined,'module':'/build/routes/_index-F4O4QEZY.js','imports':['/build/_shared/chunk-G7CHZRZX.js'],'hasAction':false,'hasLoader':true,'hasClientAction':false,'hasClientLoader':false,'hasErrorBoundary':false},'routes/admin':{'id':'routes/admin','parentId':'root','path':'admin','index':undefined,'caseSensitive':undefined,'module':'/build/routes/admin-C3XB5OOM.js','imports':['/build/_shared/chunk-EV32D4DT.js','/build/_shared/chunk-G7CHZRZX.js'],'hasAction':false,'hasLoader':true,'hasClientAction':false,'hasClientLoader':false,'hasErrorBoundary':false},'routes/admin.branding':{'id':'routes/admin.branding','parentId':'routes/admin','path':'branding','index':undefined,'caseSensitive':undefined,'module':'/build/routes/admin.branding-2H2IKNQC.js','imports':['/build/_shared/chunk-ANTKSAN7.js'],'hasAction':true,'hasLoader':true,'hasClientAction':false,'hasClientLoader':false,'hasErrorBoundary':false},'routes/api.config':{'id':'routes/api.config','parentId':'root','path':'api/config','index':undefined,'caseSensitive':undefined,'module':'/build/routes/api.config-F6QT7IN6.js','imports':undefined,'hasAction':false,'hasLoader':true,'hasClientAction':false,'hasClientLoader':false,'hasErrorBoundary':false},'routes/api.settings':{'id':'routes/api.settings','parentId':'root','path':'api/settings','index':undefined,'caseSensitive':undefined,'module':'/build/routes/api.settings-C6JUPEZG.js','imports':undefined,'hasAction':true,'hasLoader':false,'hasClientAction':false,'hasClientLoader':false,'hasErrorBoundary':false},'routes/auth.callback':{'id':'routes/auth.callback','parentId':'root','path':'auth/callback','index':undefined,'caseSensitive':undefined,'module':'/build/routes/auth.callback-HTHTBQTT.js','imports':undefined,'hasAction':false,'hasLoader':true,'hasClientAction':false,'hasClientLoader':false,'hasErrorBoundary':false},'routes/auth.install':{'id':'routes/auth.install','parentId':'root','path':'auth/install','index':undefined,'caseSensitive':undefined,'module':'/build/routes/auth.install-GWWDNMQD.js','imports':undefined,'hasAction':false,'hasLoader':true,'hasClientAction':false,'hasClientLoader':false,'hasErrorBoundary':false},'routes/healthz':{'id':'routes/healthz','parentId':'root','path':'healthz','index':undefined,'caseSensitive':undefined,'module':'/build/routes/healthz-47L4ZWTK.js','imports':undefined,'hasAction':false,'hasLoader':true,'hasClientAction':false,'hasClientLoader':false,'hasErrorBoundary':false},'routes/test.oauth':{'id':'routes/test.oauth','parentId':'root','path':'test/oauth','index':undefined,'caseSensitive':undefined,'module':'/build/routes/test.oauth-RBOJFKPL.js','imports':['/build/_shared/chunk-G7CHZRZX.js'],'hasAction':false,'hasLoader':true,'hasClientAction':false,'hasClientLoader':false,'hasErrorBoundary':false},'routes/webhooks.app_uninstalled':{'id':'routes/webhooks.app_uninstalled','parentId':'root','path':'webhooks/app_uninstalled','index':undefined,'caseSensitive':undefined,'module':'/build/routes/webhooks.app_uninstalled-QBHIURQQ.js','imports':undefined,'hasAction':true,'hasLoader':false,'hasClientAction':false,'hasClientLoader':false,'hasErrorBoundary':false},'routes/webhooks.products_update':{'id':'routes/webhooks.products_update','parentId':'root','path':'webhooks/products_update','index':undefined,'caseSensitive':undefined,'module':'/build/routes/webhooks.products_update-JGCI7S77.js','imports':undefined,'hasAction':true,'hasLoader':false,'hasClientAction':false,'hasClientLoader':false,'hasErrorBoundary':false}},'version':'e1a0ea70','hmr':{'runtime':'/build/_shared/chunk-ALN5UVCC.js','timestamp':1755762765999},'url':'/build/manifest-E1A0EA70.js'};", "\nimport * as entryServer from \"/Users/zeynel/Desktop/TurnApp/turnapp/node_modules/@remix-run/dev/dist/config/defaults/entry.server.node.tsx\";\nimport * as route0 from \"./root.tsx\";\nimport * as route1 from \"./routes/webhooks.app_uninstalled.tsx\";\nimport * as route2 from \"./routes/webhooks.products_update.tsx\";\nimport * as route3 from \"./routes/admin.branding.tsx\";\nimport * as route4 from \"./routes/auth.callback.tsx\";\nimport * as route5 from \"./routes/api.settings.tsx\";\nimport * as route6 from \"./routes/auth.install.tsx\";\nimport * as route7 from \"./routes/api.config.tsx\";\nimport * as route8 from \"./routes/test.oauth.tsx\";\nimport * as route9 from \"./routes/healthz.tsx\";\nimport * as route10 from \"./routes/_index.tsx\";\nimport * as route11 from \"./routes/admin.tsx\";\n  export const mode = \"development\";\n  export { default as assets } from \"@remix-run/dev/assets-manifest\";\n  export const assetsBuildDirectory = \"public/build\";\n  export const future = {\"v3_fetcherPersist\":false,\"v3_relativeSplatPath\":false,\"v3_throwAbortReason\":false,\"v3_routeConfig\":false,\"v3_singleFetch\":false,\"v3_lazyRouteDiscovery\":false,\"unstable_optimizeDeps\":false};\n  export const publicPath = \"/build/\";\n  export const entry = { module: entryServer };\n  export const routes = {\n    \"root\": {\n      id: \"root\",\n      parentId: undefined,\n      path: \"\",\n      index: undefined,\n      caseSensitive: undefined,\n      module: route0\n    },\n  \"routes/webhooks.app_uninstalled\": {\n      id: \"routes/webhooks.app_uninstalled\",\n      parentId: \"root\",\n      path: \"webhooks/app_uninstalled\",\n      index: undefined,\n      caseSensitive: undefined,\n      module: route1\n    },\n  \"routes/webhooks.products_update\": {\n      id: \"routes/webhooks.products_update\",\n      parentId: \"root\",\n      path: \"webhooks/products_update\",\n      index: undefined,\n      caseSensitive: undefined,\n      module: route2\n    },\n  \"routes/admin.branding\": {\n      id: \"routes/admin.branding\",\n      parentId: \"routes/admin\",\n      path: \"branding\",\n      index: undefined,\n      caseSensitive: undefined,\n      module: route3\n    },\n  \"routes/auth.callback\": {\n      id: \"routes/auth.callback\",\n      parentId: \"root\",\n      path: \"auth/callback\",\n      index: undefined,\n      caseSensitive: undefined,\n      module: route4\n    },\n  \"routes/api.settings\": {\n      id: \"routes/api.settings\",\n      parentId: \"root\",\n      path: \"api/settings\",\n      index: undefined,\n      caseSensitive: undefined,\n      module: route5\n    },\n  \"routes/auth.install\": {\n      id: \"routes/auth.install\",\n      parentId: \"root\",\n      path: \"auth/install\",\n      index: undefined,\n      caseSensitive: undefined,\n      module: route6\n    },\n  \"routes/api.config\": {\n      id: \"routes/api.config\",\n      parentId: \"root\",\n      path: \"api/config\",\n      index: undefined,\n      caseSensitive: undefined,\n      module: route7\n    },\n  \"routes/test.oauth\": {\n      id: \"routes/test.oauth\",\n      parentId: \"root\",\n      path: \"test/oauth\",\n      index: undefined,\n      caseSensitive: undefined,\n      module: route8\n    },\n  \"routes/healthz\": {\n      id: \"routes/healthz\",\n      parentId: \"root\",\n      path: \"healthz\",\n      index: undefined,\n      caseSensitive: undefined,\n      module: route9\n    },\n  \"routes/_index\": {\n      id: \"routes/_index\",\n      parentId: \"root\",\n      path: undefined,\n      index: true,\n      caseSensitive: undefined,\n      module: route10\n    },\n  \"routes/admin\": {\n      id: \"routes/admin\",\n      parentId: \"root\",\n      path: \"admin\",\n      index: undefined,\n      caseSensitive: undefined,\n      module: route11\n    }\n  };"],
  "mappings": "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",
  "names": ["jsxDEV", "action", "json", "action", "json", "action", "json", "createHmac", "jsxDEV", "json", "action", "loader", "createHmac", "timingSafeEqual", "createHmac", "salt", "loader", "action", "json", "action", "json", "loader", "redirect", "loader", "redirect", "loader", "json", "loader", "json", "loader", "json", "useLoaderData", "jsxDEV", "loader", "json", "loader", "json", "loader", "json", "useLoaderData", "Link", "jsxDEV", "loader", "json", "useLoaderData", "Link", "loader", "json", "useLoaderData", "Outlet", "Link", "Layout", "Page", "Text", "Card", "Button", "useState", "useCallback", "jsxDEV", "loader", "json", "useLoaderData", "mobileNavigationActive", "Link", "Outlet"]
}
